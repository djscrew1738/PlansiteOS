# üöÄ PlansiteOS Quick Start Guide

**Last Updated**: January 20, 2026
**Your Network Configuration**: Configured and Ready

---

## One-Command Launch

```bash
cd /home/user/PlansiteOS
./setup.sh
```

That's it! The `setup.sh` script will:
- ‚úÖ Check and start PostgreSQL
- ‚úÖ Create database if needed
- ‚úÖ Run all migrations
- ‚úÖ Configure environment files
- ‚úÖ Install dependencies
- ‚úÖ Start both backend and frontend
- ‚úÖ Show you all access URLs

---

## Your Network Configuration

Your PlansiteOS installation is configured for multi-network access:

### Local Access
- **Frontend**: http://localhost:5173
- **Backend API**: http://localhost:8090
- **Health Check**: http://localhost:8090/api/health

### Network Access (LAN)
- **Frontend**: http://192.168.1.215:5173
- **Backend API**: http://192.168.1.215:8090
- **Health Check**: http://192.168.1.215:8090/api/health

### Tailscale Access
- **Frontend**: http://100.109.158.92:5173
- **Backend API**: http://100.109.158.92:8090
- **Health Check**: http://100.109.158.92:8090/api/health

### Domain Access (Production)
- **Website**: https://cbrnholdings.com
- **API**: https://cbrnholdings.com/api

---

## Default Login

After launching, login with:
- **Email**: `admin@ctlplumbing.com`
- **Password**: `admin123`

**‚ö†Ô∏è IMPORTANT**: Change this password immediately after first login!

---

## Service Management

### Start Everything
```bash
./setup.sh
```

### Stop Everything
```bash
./stop.sh
```

### View Logs
```bash
# Real-time logs (both services)
tail -f backend.log frontend.log

# Backend only
tail -f backend.log

# Frontend only
tail -f frontend.log
```

### Check Health
```bash
curl http://localhost:8090/api/health | jq
```

---

## What's Included

‚úÖ **Complete Application Stack**
- Backend API (Express.js)
- Frontend UI (React with Vite)
- PostgreSQL database
- User authentication (JWT)
- Leads management
- Blueprint upload & analysis
- Analytics dashboard
- Notification system (SMS & Email)

‚úÖ **Stability Features**
- Automatic database connection retry
- Query retry for transient errors
- Connection pool monitoring
- Comprehensive health checks
- CORS configured for multi-network
- Graceful error handling
- System resource monitoring

‚úÖ **Network Features**
- Multi-network CORS support
- Local, LAN, and VPN access
- Domain-ready configuration
- Secure credential management

---

## First Time Setup

If this is your first time, the `setup.sh` script handles everything automatically:

1. **PostgreSQL**: Checks if running, starts if needed
2. **Database**: Creates `plansiteos` database if not exists
3. **Migrations**: Runs all schema migrations
4. **Environment**: Creates .env files with your network config
5. **Dependencies**: Installs all npm packages
6. **Services**: Starts backend and frontend

You literally just run `./setup.sh` and everything is ready!

---

## Manual Setup (Alternative)

If you prefer to run steps manually:

```bash
# 1. Start PostgreSQL
sudo systemctl start postgresql

# 2. Create database
createdb plansiteos

# 3. Run migrations
psql postgresql://postgres:postgres@localhost:5432/plansiteos -f migrations/add_leads_support.sql
psql postgresql://postgres:postgres@localhost:5432/plansiteos -f migrations/add_user_authentication.sql
psql postgresql://postgres:postgres@localhost:5432/plansiteos -f migrations/add_blueprint_analysis.sql

# 4. Install dependencies
cd apps/api && npm install && cd ../..
cd apps/web && npm install && cd ../..

# 5. Start backend (Terminal 1)
cd apps/api && npm run dev

# 6. Start frontend (Terminal 2)
cd apps/web && npm run dev
```

---

## Environment Variables

Your environment files are automatically generated by `setup.sh`:

### Backend (.env location: `apps/api/.env`)
```bash
# Database
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/plansiteos

# Server
PORT=8090
HOST=0.0.0.0

# Network
LOCAL_IP=192.168.1.215
TAILSCALE_IP=100.109.158.92
DOMAIN=cbrnholdings.com

# JWT
JWT_SECRET=<auto-generated>
JWT_EXPIRES_IN=15m
REFRESH_TOKEN_EXPIRES_IN=7d

# CORS
CORS_ORIGIN=http://localhost:5173,http://192.168.1.215:5173,...

# Optional API Keys (uncomment and add)
# ANTHROPIC_API_KEY=sk-ant-...
# TWILIO_ACCOUNT_SID=...
# SENDGRID_API_KEY=...
```

### Frontend (.env location: `apps/web/.env`)
```bash
VITE_API_URL=http://192.168.1.215:8090
```

---

## API Endpoints

### Authentication
- `POST /api/v1/auth/register` - Create new user
- `POST /api/v1/auth/login` - Login
- `POST /api/v1/auth/refresh` - Refresh token
- `GET /api/v1/auth/me` - Get current user

### Leads
- `GET /api/v1/leads` - List all leads
- `POST /api/v1/leads` - Create lead
- `PATCH /api/v1/leads/:id/status` - Update status
- `GET /api/v1/leads/statistics` - Get stats

### Blueprints
- `POST /api/v1/blueprints/upload` - Upload blueprint
- `GET /api/v1/blueprints` - List blueprints
- `GET /api/v1/blueprints/:id` - Get blueprint details

### Analytics
- `GET /api/v1/analytics/stats` - Dashboard stats
- `GET /api/v1/analytics/fixtures` - Fixture breakdown

### Health
- `GET /api/health` - Comprehensive health check

---

## Features Overview

### 1. User Authentication
- JWT-based authentication
- Refresh token support
- Account lockout protection
- Role-based authorization
- Session management

### 2. Leads Management
- Complete CRUD operations
- Status workflow (new ‚Üí contacted ‚Üí qualified ‚Üí converted)
- Priority scoring
- Service area matching
- Search and filtering

### 3. Blueprint Upload & Analysis
- AI-powered analysis (Claude Vision)
- Multi-format support (PDF, PNG, JPG, DXF)
- Fixture detection and counting
- Room-by-room breakdown
- Measurement extraction

### 4. Notifications
- Twilio SMS integration
- SendGrid email integration
- High-priority lead alerts
- Professional HTML templates

### 5. Analytics Dashboard
- Real-time statistics
- Fixture breakdown
- Performance metrics
- Activity tracking

---

## Troubleshooting

### "PostgreSQL not running"
```bash
sudo systemctl start postgresql
# or
sudo service postgresql start
```

### "Port already in use"
The setup script automatically kills processes on ports 8090 and 5173.
Or manually:
```bash
sudo lsof -ti:8090 | xargs sudo kill -9
sudo lsof -ti:5173 | xargs sudo kill -9
```

### "Database connection failed"
```bash
# Check PostgreSQL is running
pg_isready

# Check database exists
psql -l | grep plansiteos

# Test connection
psql postgresql://postgres:postgres@localhost:5432/plansiteos -c "SELECT 1;"
```

### "Module not found" errors
```bash
# Reinstall dependencies
cd apps/api && rm -rf node_modules && npm install
cd apps/web && rm -rf node_modules && npm install
```

### "Can't access from other devices"
Make sure:
1. Firewall allows ports 3000 and 5000
2. Backend is listening on 0.0.0.0 (it should be by default)
3. Your network IP (192.168.1.215) is correct

```bash
# Check what the backend is listening on
sudo lsof -i:8090
```

---

## Health Monitoring

Check application health:
```bash
curl http://localhost:8090/api/health | jq
```

Response includes:
- ‚úÖ Database connection status
- ‚úÖ Connection pool stats
- ‚úÖ AI service status
- ‚úÖ Notification service status
- ‚úÖ Memory usage
- ‚úÖ CPU usage
- ‚úÖ Uptime

---

## Production Deployment

For production deployment:

1. **Update .env files** with production values
2. **Change JWT_SECRET** to a strong random string
3. **Enable SSL** on database connection
4. **Add API keys** (Anthropic, Twilio, SendGrid)
5. **Configure domain** properly
6. **Set NODE_ENV=production**
7. **Use process manager** (PM2, systemd)
8. **Enable HTTPS** with reverse proxy (nginx, caddy)
9. **Set up monitoring** (New Relic, DataDog, etc.)
10. **Configure backups** for database

---

## Performance

Expected performance:
- **API Response**: < 100ms for most endpoints
- **Database Queries**: < 50ms average
- **Blueprint Analysis**: 5-15 seconds (AI processing)
- **Memory Usage**: ~200MB backend, ~100MB frontend
- **Connection Pool**: 2-20 connections

---

## Security Checklist

- [ ] Change default admin password
- [ ] Update JWT_SECRET in production
- [ ] Enable database SSL in production
- [ ] Configure firewall rules
- [ ] Enable HTTPS
- [ ] Set secure cookie flags
- [ ] Configure rate limiting
- [ ] Enable audit logging
- [ ] Regular security updates
- [ ] Monitor for suspicious activity

---

## Support & Documentation

### Documentation Files
- `LAUNCH_GUIDE.md` - Detailed launch instructions
- `BLUEPRINT_UPLOAD_GUIDE.md` - Blueprint feature guide
- `LEADS_AND_AUTH_IMPLEMENTATION.md` - Leads & auth guide
- `IMPLEMENTATION_COMPLETE.md` - Original implementation docs
- `README.md` - Project overview

### Scripts
- `./setup.sh` - Complete automated setup
- `./start.sh` - Simple start script
- `./stop.sh` - Stop all services

### Getting Help
1. Check logs: `tail -f backend.log frontend.log`
2. Check health: `curl http://localhost:8090/api/health`
3. Review documentation in this directory
4. Check database: `psql plansiteos`

---

## Summary

‚úÖ **Everything is configured and ready to go!**

Your PlansiteOS installation is set up with:
- Multi-network access (local, LAN, Tailscale, domain)
- Complete stability improvements
- Automatic error recovery
- Comprehensive monitoring
- Production-ready features

**To launch right now:**
```bash
cd /home/user/PlansiteOS
./setup.sh
```

**Then access at:**
- Local: http://localhost:5173
- Network: http://192.168.1.215:5173
- Tailscale: http://100.109.158.92:5173

**Login with:**
- Email: admin@ctlplumbing.com
- Password: admin123

üéâ **You're all set! Happy coding!**

---

**Built with ‚ù§Ô∏è for cbrnholdings.com**
**Version**: 1.0.0
**Last Updated**: January 20, 2026
